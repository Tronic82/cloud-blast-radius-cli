# Role Restriction Policy
cloud_provider: gcp

policies:
  - name: "Developer Role Restrictions"
    type: role_restriction
    role_restriction:
      selector:
        principal_pattern: "^group:developers@.*"  # Regex: starts with group:developers@
      allowed_roles:
        - "roles/viewer"
        - "roles/bigquery.dataViewer"
        - "roles/storage.objectViewer"
      denied_roles:
        - "roles/owner"
        - "roles/editor"
        - "roles/iam.serviceAccountAdmin"

  - name: "Service Account Role Restrictions"
    type: role_restriction
    role_restriction:
      selector:
        principal_pattern: "^serviceAccount:.*-sa@.*"  # Regex: service accounts ending in -sa
      denied_roles:
        - "roles/owner"  # Service accounts should never be owners

  # Note: To exempt certain principals from role restrictions, use a more
  # specific principal_pattern or use a resource_access policy instead.
  # The role_restriction policy type does not support allowed_principals.
